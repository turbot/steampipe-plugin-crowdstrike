# Table: crowdstrike_spotlight_vulnerability

Vulnerabilities are known security risks in an operating system, application, hardware, firmware, or other part of a computing stack. Spotlight tracks vulnerabilities by industry standard frameworks like Common Vulnerabilities and Exposures (CVE). Spotlight identifies and gives info on specific vulnerabilities on your hosts using the Falcon sensor. Spotlight APIs help you integrate Spotlight into your organization's other ticketing or risk management tools.

## Examples

### Basic info

```sql
select
  created_timestamp,
  host_info -> 'hostname' AS hostname,
  status
from
  crowdstrike_spotlight_vulnerability
```

### List all known vulnerabilities

```sql
select
  created_timestamp,
  host_info -> 'hostname' AS hostname,
  status,
  app -> 'product_name_version' AS product_name_version,
  cve -> 'exprt_rating' AS exprt_rating,
  cve -> 'id' AS cve_id,
  cve -> 'description' AS cve_description
from
  crowdstrike_spotlight_vulnerability
```

### List vulnerabilities created in the last 15 days

```sql
select
  created_timestamp,
  host_info -> 'hostname' AS hostname,
  status
from
  crowdstrike_spotlight_vulnerability
where
  created_timestamp > (now() - interval '15days')
```

### List all vulnerabilities with an `exprt` rating of `critical` that were open for more than 24hrs

```sql
select
  created_timestamp,
  host_info -> 'hostname' AS hostname,
  cve,
  status
from
  crowdstrike_spotlight_vulnerability
where
  cve ->> 'exprt_rating' = 'CRITICAL'
  and status = 'closed'
  and created_timestamp - closed_timestamp > interval '24hours'
```

### List all open vulnerabilities with an `exprt` rating of `critical`

```sql
select
  created_timestamp,
  host_info -> 'hostname' AS hostname,
  cve,
  status
from
  crowdstrike_spotlight_vulnerability
where
  cve ->> 'exprt_rating' = 'CRITICAL'
  and status = 'open';
```

### List all open vulnerabilities with an `exprt` rating of `critical` with the email of the host user

```sql
select
  created_timestamp,
  host_info -> 'hostname' as hostname,
  cve,
  v.status as vuln_status,
  hosts.email,
  hosts.status as host_status
from
  crowdstrike_spotlight_vulnerability as v
  left join
    crowdstrike_host as hosts
    on host_info ->> 'hostname' = hosts.hostname
where
  cve ->> 'exprt_rating' = 'CRITICAL'
  and v.status = 'open';
```
